He thought he'd done everything right.