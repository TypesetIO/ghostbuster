The boundaries of bacterial cells were segmented using the watershed algorithm, and the fluorescence intensity of bacterial cells in each round of imaging was determined to identify their corresponding barcodes (Supplementary Fig. 2 ).