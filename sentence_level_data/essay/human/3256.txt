Written in a single pass in about 90 minutes, hopefully it's decent.