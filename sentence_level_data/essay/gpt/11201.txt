The battle was fierce and nearly cost them everything.